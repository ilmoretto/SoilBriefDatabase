<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatório Técnico: db_soil</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            color: #334155;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            color: #0f172a;
        }

        .font-mono {
            font-family: 'JetBrains Mono', monospace;
        }

        .section-header {
            position: relative;
            padding-left: 1.5rem;
            margin-bottom: 2rem;
        }

        .section-header::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0.25rem;
            bottom: 0.25rem;
            width: 4px;
            background: #2563eb;
            border-radius: 2px;
        }

        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .card-shadow:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.025);
        }

        .tech-badge {
            background-color: #f1f5f9;
            color: #475569;
            padding: 0.2rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-family: 'JetBrains Mono', monospace;
            border: 1px solid #e2e8f0;
        }

        .pill {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.15rem 0.45rem;
            border-radius: 999px;
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.02em;
        }
        
        /* Offset para navegação com navbar fixa */
        html {
            scroll-behavior: smooth;
            scroll-padding-top: 80px; /* 64px navbar + 16px margin */
        }
        
        section[id] {
            scroll-margin-top: 80px;
        }
    </style>
</head>

<body>
    <nav class="bg-white border-b border-gray-200 sticky top-0 z-50 bg-opacity-95 backdrop-blur-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center gap-2">
                    <i data-lucide="database" class="text-blue-600 h-6 w-6"></i>
                    <span class="font-bold text-xl tracking-tight text-gray-900">db_soil<span
                            class="text-gray-400 font-light">.docs</span></span>
                </div>
                <div class="hidden md:flex space-x-8 text-sm font-medium">
                    <a href="#intro" class="text-gray-600 hover:text-blue-600 transition">Introdução</a>
                    <a href="#entidades" class="text-gray-600 hover:text-blue-600 transition">Modelo de Dados</a>
                    <a href="#monitoramento" class="text-gray-600 hover:text-blue-600 transition">Monitoramento</a>
                    <a href="#historico" class="text-gray-600 hover:text-blue-600 transition">Análise Histórica</a>
                    <a href="#ddl" class="text-gray-600 hover:text-blue-600 transition">DDL</a>
                    <a href="#fluxo-iot" class="text-gray-600 hover:text-blue-600 transition">Uso/IoT</a>
                    <a href="#consultas" class="text-gray-600 hover:text-blue-600 transition">Consultas</a>
                    <a href="#relacoes" class="text-gray-600 hover:text-blue-600 transition">Relações</a>
                </div>
                <div class="md:hidden"><i data-lucide="menu" class="text-gray-600 h-6 w-6"></i></div>
            </div>
        </div>
    </nav>

    <header class="bg-white border-b border-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
            <div class="max-w-3xl">
                <div
                    class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-blue-50 text-blue-700 text-xs font-semibold uppercase tracking-wider mb-6">
                    <i data-lucide="file-text" class="w-3 h-3"></i>Relatório Técnico
                </div>
                <h1 class="text-4xl md:text-5xl font-bold mb-6 leading-tight">Estrutura do Banco de Dados <span
                        class="text-blue-600">db_soil</span></h1>
                <p class="text-xl text-gray-500 leading-relaxed mb-8">Documentação da arquitetura, design e
                    funcionalidade do Soil Brief - Sistema Integrado de Monitoramento de Fertilidade do Solo com IoT e Aplicação Móvel.</p>
                <div class="flex gap-4 text-sm text-gray-500 border-t border-gray-100 pt-6">
                    <div class="flex items-center gap-2"><i data-lucide="layout-template"
                            class="w-4 h-4"></i><span>Arquitetura Relacional</span></div>
                    <div class="flex items-center gap-2"><i data-lucide="server" class="w-4 h-4"></i><span>Soil Brief
                            IoT</span></div>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-24">
        <section id="intro" class="grid md:grid-cols-3 gap-12">
            <div class="md:col-span-1">
                <div class="section-header">
                    <h2 class="text-2xl font-bold">1. Introdução à Arquitetura de Dados</h2>
                </div>
                <p class="text-sm text-gray-500">Visão geral do propósito e escopo do banco de dados.</p>
            </div>
            <div class="md:col-span-2 prose prose-blue text-gray-600">
                <p>Este documento tem como objetivo apresentar a arquitetura, o design e a funcionalidade do banco de
                    dados <strong>db_soil</strong>. Concebido para ser a espinha dorsal do Soil Brief - Sistema Integrado de Monitoramento de Fertilidade do Solo com IoT e Aplicação Móvel, sua estrutura é fundamental para a coleta, o armazenamento e a análise de dados
                    essenciais para a agricultura de precisão.</p>
                <p>O objetivo central do banco de dados é armazenar e gerenciar, de forma integrada, informações de
                    usuários, propriedades rurais, tipos de cultura, leituras de sensores de solo e registros históricos
                    para análise.</p>
            </div>
        </section>

        <section id="entidades">
            <div class="section-header mb-8">
                <h2 class="text-2xl font-bold">2. Visão Geral do Modelo de Dados e Entidades Principais</h2>
                <p class="text-gray-500 mt-2">Para compreender o funcionamento do Soil Brief, é crucial entender suas
                    entidades centrais que refletem o mundo real.</p>
            </div>
            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-white rounded-xl p-8 border border-gray-200 card-shadow h-full">
                    <div class="flex items-start justify-between mb-6">
                        <div class="p-3 bg-indigo-50 text-indigo-600 rounded-lg"><i data-lucide="user"
                                class="w-6 h-6"></i></div>
                        <span class="tech-badge">Tabela: Usuario</span>
                    </div>
                    <h3 class="text-xl font-bold mb-3">Controle de Acesso</h3>
                    <p class="text-gray-600 mb-6 text-sm">Responsável por armazenar as informações de acesso dos
                        usuários do sistema. Centraliza os dados de identificação e autenticação de cada indivíduo
                        autorizado a interagir com a plataforma.</p>
                    <ul class="space-y-3 text-sm">
                        <li class="flex items-center justify-between border-b border-gray-50 pb-2"><span
                                class="font-mono text-gray-800">id</span><span class="text-xs text-gray-400">Chave
                                Primária (PK)</span></li>
                        <li class="flex items-center justify-between border-b border-gray-50 pb-2"><span
                                class="font-mono text-gray-800">email</span><span
                                class="text-xs text-gray-400">Identificador único</span></li>
                        <li class="flex items-center justify-between"><span
                                class="font-mono text-gray-800">senha_hash</span><span
                                class="text-xs text-gray-400">Criptografado</span></li>
                    </ul>
                </div>
                <div class="bg-white rounded-xl p-8 border border-gray-200 card-shadow h-full">
                    <div class="flex items-start justify-between mb-6">
                        <div class="p-3 bg-emerald-50 text-emerald-600 rounded-lg"><i data-lucide="map-pin"
                                class="w-6 h-6"></i></div>
                        <span class="tech-badge">Tabela: Propriedade</span>
                    </div>
                    <h3 class="text-xl font-bold mb-3">Vínculo Rural</h3>
                    <p class="text-gray-600 mb-6 text-sm">Esta entidade estabelece o vínculo entre uma propriedade rural
                        e seu respectivo dono. Ao associar cada propriedade a um registro na tabela Usuario, ela define
                        a relação de um-para-muitos, garantindo que os dados de uma fazenda sejam corretamente
                        associados ao seu gestor.</p>
                    <ul class="space-y-3 text-sm">
                        <li class="flex items-center justify-between border-b border-gray-50 pb-2"><span
                                class="font-mono text-gray-800">id</span><span class="text-xs text-gray-400">Chave
                                Primária (PK)</span></li>
                        <li class="flex items-center justify-between"><span
                                class="font-mono text-gray-800">usuario_id</span><span
                                class="text-xs text-indigo-500 font-medium">Chave Estrangeira (FK)</span></li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="monitoramento">
            <div class="section-header mb-8">
                <h2 class="text-2xl font-bold">3. Estrutura de Monitoramento e Análise de Dados</h2>
                <p class="text-gray-500 mt-2">O núcleo do sistema db_soil reside em suas entidades de monitoramento,
                    capturando dados em tempo real e permitindo análises históricas.</p>
            </div>
            <div class="grid lg:grid-cols-3 gap-6">
                <div class="bg-white p-6 rounded-lg border border-gray-200 card-shadow h-full">
                    <div class="flex items-center gap-3 mb-4"><i data-lucide="book-open"
                            class="text-amber-500 w-5 h-5"></i>
                        <h4 class="font-bold text-gray-900">1. Tabela Cultura</h4>
                    </div>
                    <p class="text-sm text-gray-600 mb-4">Funciona como uma tabela de referência, armazenando os
                        parâmetros nutricionais e ambientais considerados ideais para diversos tipos de culturas
                        agrícolas, baseados em referenciais da Embrapa.</p>
                    <div class="bg-gray-50 p-3 rounded text-xs font-mono text-gray-600">nitrogenio, fosforo, potassio,
                        umidade, temperatura</div>
                </div>
                <div
                    class="bg-white p-6 rounded-lg border-l-4 border-l-green-500 border-y border-r border-gray-200 card-shadow relative h-full">
                    <div
                        class="absolute top-0 right-0 px-2 py-1 bg-green-100 text-green-700 text-[10px] font-bold uppercase rounded-bl">
                        Core</div>
                    <div class="flex items-center gap-3 mb-4"><i data-lucide="layers"
                            class="text-green-600 w-5 h-5"></i>
                        <h4 class="font-bold text-gray-900">2. Tabela Solo</h4>
                    </div>
                    <p class="text-sm text-gray-600 mb-4">Esta é a entidade central do processo de monitoramento. Ela
                        armazena as leituras atuais dos nutrientes e das condições de uma área de solo específica. Suas
                        chaves estrangeiras contextualizam os dados. Extensibilidade para pH, condutividade, salinidade
                        e TDS conforme tipo de sensor.</p>
                    <div class="space-y-2 text-xs font-mono">
                        <div class="flex justify-between"><span>identificacao</span><span class="text-gray-400">Ex:
                                "Lote 4-Norte"</span></div>
                        <div class="flex justify-between text-indigo-600"><span>cultura_id (FK)</span><span>→
                                Cultura</span></div>
                        <div class="flex justify-between text-emerald-600"><span>propriedade_id (FK)</span><span>→
                                Propriedade</span></div>
                        <div class="text-xs text-gray-500 mt-2">Campo identificação: identificador legível por humanos
                            (ex: "Lote 4-Norte") para distinguir diferentes áreas dentro da propriedade</div>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg border border-gray-200 card-shadow h-full">
                    <div class="flex items-center gap-3 mb-4"><i data-lucide="cpu" class="text-slate-500 w-5 h-5"></i>
                        <h4 class="font-bold text-gray-900">3. Tabela Sensor</h4>
                    </div>
                    <p class="text-sm text-gray-600 mb-4">Esta tabela estabelece o vínculo fundamental entre o mundo
                        físico e o sistema lógico. Ela associa um dispositivo de hardware a uma área de solo específica
                        monitorada.</p>
                    <div class="bg-gray-50 p-3 rounded text-xs font-mono text-gray-600">id_sensor: identificador único
                        do dispositivo físico (endereço Modbus 1-255)<br>solo_id (FK): conecta sensor a área de
                        solo<br><span class="text-blue-600">Protocolos suportados:</span> Modbus RTU RS-485, registros
                        KEEP</div>
                </div>
            </div>
        </section>

        <section id="historico" class="bg-slate-900 rounded-2xl p-8 md:p-12 text-white overflow-hidden relative">
            <div class="absolute top-0 right-0 -mt-10 -mr-10 w-64 h-64 bg-slate-800 rounded-full opacity-50 blur-3xl">
            </div>
            <div class="relative z-10 grid md:grid-cols-2 gap-12 items-center">
                <div>
                    <div class="inline-flex items-center gap-2 text-blue-400 mb-4 font-mono text-sm"><i
                            data-lucide="bar-chart-2" class="w-4 h-4"></i>4. Análise Histórica</div>
                    <h3 class="text-3xl font-bold mb-4">Tabela Historico</h3>
                    <p class="text-slate-300 mb-6 leading-relaxed">Funciona como um repositório de dados agregados,
                        otimizado para a análise de tendências ao longo do tempo. Consultar médias diárias
                        pré-calculadas é ordens de magnitude mais rápido que calcular dinamicamente.</p>
                    <div class="bg-slate-800 bg-opacity-50 p-4 rounded-lg border border-slate-700">
                        <h4 class="text-sm font-semibold text-white mb-2 flex items-center gap-2"><i
                                data-lucide="shield-check" class="w-4 h-4 text-green-400"></i>Restrição Crítica</h4>
                        <p class="text-xs text-slate-400 font-mono">UNIQUE KEY unique_date_solo (data, solo_id)</p>
                        <p class="text-xs text-slate-400 mt-1">Garante a integridade referencial ao impedir a inserção
                            de mais de um registro de média diária para o mesmo solo no mesmo dia.</p>
                    </div>
                </div>
                <div class="bg-white text-slate-900 rounded-lg p-6 shadow-xl font-mono text-xs">
                    <div class="flex border-b border-gray-100 pb-2 mb-2 font-bold text-gray-400 uppercase">
                        <div class="w-1/3">Coluna</div>
                        <div class="w-2/3">Função</div>
                    </div>
                    <div class="space-y-3">
                        <div class="flex">
                            <div class="w-1/3 font-semibold text-indigo-600">data</div>
                            <div class="w-2/3 text-gray-600">Referência temporal</div>
                        </div>
                        <div class="flex">
                            <div class="w-1/3 font-semibold">nitrogenio_medio</div>
                            <div class="w-2/3 text-gray-600">Média diária de N</div>
                        </div>
                        <div class="flex">
                            <div class="w-1/3 font-semibold">fosforo_medio</div>
                            <div class="w-2/3 text-gray-600">Média diária de P</div>
                        </div>
                        <div class="flex">
                            <div class="w-1/3 font-semibold">potassio_medio</div>
                            <div class="w-2/3 text-gray-600">Média diária de K</div>
                        </div>
                        <div class="flex">
                            <div class="w-1/3 font-semibold">umidade_media</div>
                            <div class="w-2/3 text-gray-600">Média diária de umidade</div>
                        </div>
                        <div class="flex">
                            <div class="w-1/3 font-semibold">temperatura_media</div>
                            <div class="w-2/3 text-gray-600">Média diária de temperatura</div>
                        </div>
                        <div class="flex">
                            <div class="w-1/3 font-semibold text-orange-600">quantidade_leituras</div>
                            <div class="w-2/3 text-gray-600">Indica o número de medições brutas que compõem a média.
                                Serve como indicador de saúde do sensor.</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="ddl" class="bg-white border border-gray-200 rounded-2xl p-8 shadow-sm">
            <div class="section-header mb-8">
                <h2 class="text-2xl font-bold">5. Esquemas das Tabelas (DDL)</h2>
                <p class="text-gray-500 mt-2">Visualização otimizada com base no script de criação do banco.</p>
            </div>
            <div class="grid lg:grid-cols-2 gap-6">
                <div class="border border-gray-200 rounded-xl p-6 card-shadow h-full">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center gap-2"><i data-lucide="user-round"
                                class="w-5 h-5 text-indigo-600"></i>
                            <h4 class="font-bold text-gray-900">Usuario</h4>
                        </div><span class="tech-badge">PK: id</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-4">Credenciais e identidade de usuários autorizados.</p>
                    <div class="space-y-2 text-xs font-mono">
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>id</span><span
                                class="pill bg-blue-100 text-blue-700">int PK AI</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>nome</span><span
                                class="pill bg-gray-100 text-gray-700">varchar(255)</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>email</span><span
                                class="pill bg-gray-100 text-gray-700">varchar(255)</span></div>
                        <div class="flex justify-between"><span>senha_hash</span><span
                                class="pill bg-gray-100 text-gray-700">varchar(255)</span></div>
                    </div>
                </div>
                <div class="border border-gray-200 rounded-xl p-6 card-shadow h-full">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center gap-2"><i data-lucide="map" class="w-5 h-5 text-emerald-600"></i>
                            <h4 class="font-bold text-gray-900">Propriedade</h4>
                        </div><span class="tech-badge">FK → Usuario</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-4">Vínculo entre a fazenda e o usuário dono.</p>
                    <div class="space-y-2 text-xs font-mono">
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>id</span><span
                                class="pill bg-blue-100 text-blue-700">int PK AI</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>nome</span><span
                                class="pill bg-gray-100 text-gray-700">varchar(255)</span></div>
                        <div class="flex justify-between"><span>usuario_id</span><span
                                class="pill bg-indigo-100 text-indigo-700">int FK not null</span></div>
                    </div>
                </div>
                <div class="border border-gray-200 rounded-xl p-6 card-shadow h-full">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center gap-2"><i data-lucide="sprout" class="w-5 h-5 text-amber-600"></i>
                            <h4 class="font-bold text-gray-900">Cultura</h4>
                        </div><span class="tech-badge">Referências NPK</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-4">Valores ideais (Embrapa) para diagnóstico por cultura.</p>
                    <div class="grid grid-cols-2 text-xs font-mono gap-2">
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>id</span><span
                                class="pill bg-blue-100 text-blue-700">int PK AI</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>nome</span><span
                                class="pill bg-gray-100 text-gray-700">varchar(255)</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2 col-span-2">
                            <span>nitrogenio</span><span class="pill bg-gray-100 text-gray-700">double</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2 col-span-2">
                            <span>fosforo</span><span class="pill bg-gray-100 text-gray-700">double</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2 col-span-2">
                            <span>potassio</span><span class="pill bg-gray-100 text-gray-700">double</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2 col-span-2">
                            <span>umidade</span><span class="pill bg-gray-100 text-gray-700">double</span></div>
                        <div class="flex justify-between col-span-2"><span>temperatura</span><span
                                class="pill bg-gray-100 text-gray-700">double</span></div>
                    </div>
                </div>
                <div class="border border-gray-200 rounded-xl p-6 card-shadow h-full">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center gap-2"><i data-lucide="layers" class="w-5 h-5 text-green-600"></i>
                            <h4 class="font-bold text-gray-900">Solo</h4>
                        </div><span class="tech-badge">FK → Cultura / Propriedade</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-4">Leituras atuais por área; pode existir sem cultura (pousio).
                    </p>
                    <div class="grid grid-cols-2 text-xs font-mono gap-2">
                        <div class="flex justify-between border-b border-gray-100 pb-2 col-span-2"><span>id</span><span
                                class="pill bg-blue-100 text-blue-700">int PK AI</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2 col-span-2">
                            <span>identificacao</span><span class="pill bg-gray-100 text-gray-700">varchar(50)</span>
                        </div>
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>nitrogenio</span><span
                                class="pill bg-gray-100 text-gray-700">double</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>fosforo</span><span
                                class="pill bg-gray-100 text-gray-700">double</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>potassio</span><span
                                class="pill bg-gray-100 text-gray-700">double</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>umidade</span><span
                                class="pill bg-gray-100 text-gray-700">double</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>temperatura</span><span
                                class="pill bg-gray-100 text-gray-700">double</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>cultura_id</span><span
                                class="pill bg-amber-100 text-amber-700">int FK null</span></div>
                        <div class="flex justify-between"><span>propriedade_id</span><span
                                class="pill bg-indigo-100 text-indigo-700">int FK not null</span></div>
                    </div>
                </div>
                <div class="border border-gray-200 rounded-xl p-6 card-shadow h-full">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center gap-2"><i data-lucide="cpu" class="w-5 h-5 text-slate-600"></i>
                            <h4 class="font-bold text-gray-900">Sensor</h4>
                        </div><span class="tech-badge">FK → Solo</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-4">Mapeia dispositivos físicos aos solos monitorados.</p>
                    <div class="space-y-2 text-xs font-mono">
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>id</span><span
                                class="pill bg-blue-100 text-blue-700">int PK AI</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>id_sensor</span><span
                                class="pill bg-gray-100 text-gray-700">varchar(10)</span></div>
                        <div class="flex justify-between"><span>solo_id</span><span
                                class="pill bg-indigo-100 text-indigo-700">int FK</span></div>
                    </div>
                </div>
                <div class="border border-gray-200 rounded-xl p-6 card-shadow lg:col-span-2 h-full">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center gap-2"><i data-lucide="history"
                                class="w-5 h-5 text-purple-600"></i>
                            <h4 class="font-bold text-gray-900">Historico</h4>
                        </div><span class="tech-badge">UNIQUE (data, solo_id)</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-4">Médias diárias consolidadas por solo; garante unicidade por
                        dia.</p>
                    <div class="grid grid-cols-2 md:grid-cols-3 text-xs font-mono gap-2">
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>id</span><span
                                class="pill bg-blue-100 text-blue-700">int PK AI</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>data</span><span
                                class="pill bg-gray-100 text-gray-700">date not null</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2">
                            <span>nitrogenio_medio</span><span class="pill bg-gray-100 text-gray-700">double</span>
                        </div>
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>fosforo_medio</span><span
                                class="pill bg-gray-100 text-gray-700">double</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>potassio_medio</span><span
                                class="pill bg-gray-100 text-gray-700">double</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2"><span>umidade_media</span><span
                                class="pill bg-gray-100 text-gray-700">double</span></div>
                        <div class="flex justify-between border-b border-gray-100 pb-2">
                            <span>temperatura_media</span><span class="pill bg-gray-100 text-gray-700">double</span>
                        </div>
                        <div class="flex justify-between border-b border-gray-100 pb-2">
                            <span>quantidade_leituras</span><span class="pill bg-gray-100 text-gray-700">int not
                                null</span></div>
                        <div class="flex justify-between"><span>solo_id</span><span
                                class="pill bg-indigo-100 text-indigo-700">int FK not null</span></div>
                    </div>
                </div>
            </div>
        </section>

        <section id="fluxo-iot" class="bg-white border border-gray-200 rounded-2xl p-8 shadow-sm">
            <div class="section-header mb-8">
                <h2 class="text-2xl font-bold">6. Uso do Banco de Dados na Arquitetura IoT</h2>
                <p class="text-gray-500 mt-2">Integração hardware → API → MySQL → App (conforme Relatório Técnico IoT).
                </p>
            </div>

            <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8">
                <h3 class="text-lg font-bold text-blue-900 mb-4 flex items-center gap-2"><i data-lucide="cpu"
                        class="w-5 h-5"></i>Tipos de Sensores Suportados pelo Sistema</h3>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm">
                    <div class="bg-white p-4 rounded border">
                        <h4 class="font-semibold text-gray-800 mb-2">NPK Básico</h4>
                        <ul class="text-xs text-gray-600 space-y-1">
                            <li>Nitrogênio (N) - Reg 31</li>
                            <li>Fósforo (P) - Reg 32</li>
                            <li>Potássio (K) - Reg 33</li>
                        </ul>
                    </div>
                    <div class="bg-white p-4 rounded border">
                        <h4 class="font-semibold text-gray-800 mb-2">TH & TH-EC</h4>
                        <ul class="text-xs text-gray-600 space-y-1">
                            <li>Umidade - Reg 1 (x0.1)</li>
                            <li>Temperatura - Reg 2 (x0.1)</li>
                            <li>Condutividade - Reg 3</li>
                        </ul>
                    </div>
                    <div class="bg-white p-4 rounded border">
                        <h4 class="font-semibold text-gray-800 mb-2">Multi-Parâmetros</h4>
                        <ul class="text-xs text-gray-600 space-y-1">
                            <li>pH - Reg 4 (x0.1)</li>
                            <li>Salinidade - Reg 8</li>
                            <li>TDS - Reg 9</li>
                        </ul>
                    </div>
                </div>
                <p class="text-xs text-blue-700 mt-3"><strong>Observação:</strong> Todos os sensores utilizam protocolo
                    Modbus RTU com endereços configuráveis (1-255) e fatores de calibração personalizados.</p>
            </div>

            <div class="bg-slate-50 border border-slate-200 rounded-xl p-6 mt-8">
                <h4 class="font-semibold text-gray-800 mb-4 flex items-center gap-2"><i data-lucide="code"
                        class="w-4 h-4 text-slate-700"></i>Especificações Técnicas de Comunicação</h4>
                <div class="grid lg:grid-cols-2 gap-6">
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <h5 class="font-semibold text-gray-700 mb-3">Registros Modbus (Exemplos)</h5>
                        <div class="text-xs font-mono space-y-1 text-gray-600">
                            <div class="flex justify-between"><span>NPK Nitrogen:</span><span class="text-blue-600">Reg
                                    31 (Signed)</span></div>
                            <div class="flex justify-between"><span>Humidity:</span><span class="text-green-600">Reg 1
                                    (Signed x0.1)</span></div>
                            <div class="flex justify-between"><span>Temperature:</span><span class="text-red-600">Reg 2
                                    (Signed x0.1)</span></div>
                            <div class="flex justify-between"><span>pH:</span><span class="text-purple-600">Reg 4
                                    (Signed x0.1)</span></div>
                            <div class="flex justify-between"><span>Conductivity:</span><span
                                    class="text-yellow-600">Reg 3 (Signed)</span></div>
                        </div>
                    </div>
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <h5 class="font-semibold text-gray-700 mb-3">Payload JSON (API)</h5>
                        <pre class="text-xs bg-slate-800 text-slate-200 p-3 rounded overflow-x-auto">{
  "sensorId": "NPK_001",
  "timestamp": "2025-01-15T14:30:00Z",
  "soloId": 1,
  "leituras": {
    "nitrogenio": 45.5,
    "fosforo": 28.3,
    "potassio": 180.2,
    "umidade": 70.5,
    "temperatura": 24.8,
    "ph": 6.2,
    "condutividade": 1250
  }
}</pre>
                    </div>
                </div>
                <p class="text-xs text-slate-600 mt-3"><strong>Nota:</strong> Valores com fator de escala (x0.1) são
                    automaticamente convertidos pela API antes da persistência no banco.</p>
            </div>
            <div class="grid md:grid-cols-3 gap-6 mb-8">
                <div class="p-5 bg-slate-50 border border-slate-200 rounded-lg h-full">
                    <div class="flex items-center gap-2 text-slate-700 font-semibold mb-2"><i data-lucide="box"
                            class="w-4 h-4"></i>Camada de Percepção</div>
                    <p class="text-sm text-slate-600">Arduino Uno + Sensores multi-parâmetro via Modbus RS-485 (MAX485).
                        Suporte a NPK, pH, condutividade, salinidade e TDS. Leituras a cada 15 minutos.</p>
                </div>
                <div class="p-5 bg-slate-50 border border-slate-200 rounded-lg h-full">
                    <div class="flex items-center gap-2 text-slate-700 font-semibold mb-2"><i data-lucide="wifi"
                            class="w-4 h-4"></i>Rede & Middleware</div>
                    <p class="text-sm text-slate-600">ESP8266 publica via HTTP/REST (POST JSON). API .NET do Soil Brief valida e
                        persiste no MySQL; taxa de sucesso > 90%.</p>
                </div>
                <div class="p-5 bg-slate-50 border border-slate-200 rounded-lg h-full">
                    <div class="flex items-center gap-2 text-slate-700 font-semibold mb-2"><i data-lucide="smartphone"
                            class="w-4 h-4"></i>Aplicação Móvel Soil Brief</div>
                    <p class="text-sm text-slate-600">Consome API via GET para dashboards com semáforo
                        (verde/amarelo/vermelho) por cultura.</p>
                </div>
            </div>
            <div class="grid lg:grid-cols-2 gap-6 items-stretch">
                <div class="bg-slate-900 text-slate-100 rounded-xl p-6">
                    <h4 class="text-lg font-semibold mb-3 flex items-center gap-2"><i data-lucide="workflow"
                            class="w-4 h-4 text-blue-300"></i>Fluxo resumido (dados → diagnóstico)</h4>
                    <pre class="bg-slate-800 text-slate-200 p-4 rounded-lg text-xs font-mono leading-6 overflow-x-auto">Sensores Multi-parâmetro (NPK, pH, TH, EC)
  → Modbus RTU RS-485 (endereços 1-255)
  → MAX485 (conversão RS-485/TTL)
Arduino Uno (mestre Modbus)
  → Serial TX/RX (9600-115200 baud)
ESP8266 (Wi-Fi + HTTP client)
  → HTTP POST JSON (payload estruturado)
API .NET (validação + regras de negócio)
  → INSERT/UPDATE (Solo + Historico)
MySQL 8.0+ (ACID + índices otimizados)
  → GET /diagnostico (comparação culturas)
Soil Brief App React Native (dashboard responsivo)</pre>
                </div>
                <div class="bg-white border border-gray-200 rounded-xl p-6">
                    <h4 class="text-lg font-semibold mb-3 flex items-center gap-2"><i data-lucide="list-checks"
                            class="w-4 h-4 text-emerald-500"></i>Pontos críticos do banco</h4>
                    <ul class="space-y-3 text-sm text-gray-700">
                        <li><strong>Integridade:</strong> FKs em Solo (propriedade_id, cultura_id opcional) e Historico
                            (solo_id).</li>
                        <li><strong>Unicidade diária:</strong> UNIQUE (data, solo_id) na Historico evita médias
                            duplicadas.</li>
                        <li><strong>Latência:</strong> Resposta &lt; 2s no app após POST/GET.</li>
                        <li><strong>Diagnóstico:</strong> API compara leituras com tabela Cultura (RF9) e retorna status
                            ao app.</li>
                        <li><strong>Escalabilidade:</strong> Suporte a múltiplos tipos de sensor via id_sensor com
                            endereçamento Modbus flexível.</li>
                        <li><strong>Calibração:</strong> Fatores de correção armazenados nos próprios sensores
                            (registros 35-37, 1257-1279).</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="consultas" class="border border-gray-200 rounded-2xl p-8 bg-white shadow-sm">
            <div class="section-header mb-6">
                <h2 class="text-2xl font-bold">7. Consultas SQL e Visualização</h2>
                <p class="text-gray-500 mt-2">Exemplos de consultas e pré-visualização com dados de povoamento.</p>
            </div>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-5 h-full">
                    <h4 class="font-semibold text-gray-800 mb-3">Médias diárias por propriedade e cultura</h4>
                    <pre
                        class="text-xs font-mono text-gray-800 overflow-x-auto bg-white border border-gray-200 rounded p-3">SELECT p.id   AS propriedade,
       s.identificacao,
       c.nome AS cultura,
       h.data,
       h.nitrogenio_medio,
       h.fosforo_medio,
       h.potassio_medio,
       h.umidade_media,
       h.temperatura_media,
       h.quantidade_leituras
FROM historico h
JOIN solo s         ON s.id = h.solo_id
JOIN propriedade p  ON p.id = s.propriedade_id
LEFT JOIN cultura c ON c.id = s.cultura_id
WHERE h.data BETWEEN '2025-01-01' AND '2025-01-31'
ORDER BY p.id, s.identificacao, h.data;</pre>
                </div>
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-5 h-full">
                    <h4 class="font-semibold text-gray-800 mb-3">Diagnóstico comparando com referência da cultura</h4>
                    <pre
                        class="text-xs font-mono text-gray-800 overflow-x-auto bg-white border border-gray-200 rounded p-3">SELECT s.identificacao,
       c.nome AS cultura,
       h.data,
       h.fosforo_medio,
       c.fosforo AS fosforo_ref_min,
       CASE
         WHEN h.fosforo_medio < c.fosforo THEN 'Crítico: abaixo do ideal'
         WHEN h.fosforo_medio > c.fosforo * 1.2 THEN 'Alerta: acima do ideal'
         ELSE 'Ok: dentro da faixa'
       END AS status_fosforo
FROM historico h
JOIN solo s     ON s.id = h.solo_id
JOIN cultura c  ON c.id = s.cultura_id
WHERE h.data = CURDATE() AND c.nome = 'Soja';</pre>
                    <p class="text-xs text-gray-600 mt-2">Exemplo expandido: sistema de três níveis (crítico/alerta/ok)
                        baseado em tolerâncias de 20% sobre valores de referência da Embrapa.</p>
                </div>
            </div>
            <div class="mt-8 bg-slate-50 border border-slate-200 rounded-xl p-6">
                <h4 class="font-semibold text-gray-800 mb-3 flex items-center gap-2"><i data-lucide="table"
                        class="w-4 h-4 text-slate-700"></i>Pré-visualização de dados (povoamento)</h4>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4 text-xs font-mono text-slate-800">
                    <div class="bg-white border border-gray-200 rounded-lg p-3">
                        <div class="font-semibold text-gray-700 mb-2">Usuario</div>
                        <div>id=1 · Guilherme Tavares</div>
                        <div>email=guilherme.tavares@soilbrief.com</div>
                    </div>
                    <div class="bg-white border border-gray-200 rounded-lg p-3">
                        <div class="font-semibold text-gray-700 mb-2">Propriedade</div>
                        <div>id=1 · Serra Azul</div>
                        <div>usuario_id=1</div>
                    </div>
                    <div class="bg-white border border-gray-200 rounded-lg p-3">
                        <div class="font-semibold text-gray-700 mb-2">Solo</div>
                        <div>id=1 · "Lavoura"</div>
                        <div>cultura_id=1 (Trigo) · propriedade_id=1</div>
                        <div>N=45.5 P=28.3 K=180.2 Umid=70.5 Temp=29°C</div>
                    </div>
                    <div class="bg-white border border-gray-200 rounded-lg p-3">
                        <div class="font-semibold text-gray-700 mb-2">Cultura (amostras)</div>
                        <div>1 Trigo · 60/45/250</div>
                        <div>2 Milho · 80/60/300</div>
                        <div>3 Soja · 50/40/200</div>
                    </div>
                    <div class="bg-white border border-gray-200 rounded-lg p-3 md:col-span-2 lg:col-span-2">
                        <div class="font-semibold text-gray-700 mb-2">Historico (exemplos)</div>
                        <div>2024-01-05 · NPK 52/38/210 · Umid 68 · Temp 24 · leituras 200</div>
                        <div>2024-03-25 · NPK 59/45/228 · Umid 74 · Temp 29 · leituras 200</div>
                        <div>2025-04-12 · NPK 63/49/240 · Umid 78 · Temp 28 · leituras 200</div>
                    </div>
                </div>
            </div>
        </section>

        <section id="relacoes">
            <div class="section-header mb-8">
                <h2 class="text-2xl font-bold">8. Relações e Fluxo de Dados</h2>
                <p class="text-gray-500 mt-2">A força de um banco de dados relacional reside nas conexões lógicas entre
                    suas tabelas, implementadas através de chaves estrangeiras.</p>
            </div>
            <div class="grid md:grid-cols-2 lg:grid-cols-5 gap-4">
                <div class="p-4 border border-gray-200 rounded-lg flex flex-col items-center text-center bg-white"><i
                        data-lucide="users" class="w-8 h-8 text-blue-600 mb-3"></i>
                    <h4 class="font-bold text-sm mb-1">Propriedade → Usuario</h4>
                    <p class="text-xs text-gray-500">Um usuário pode possuir múltiplas propriedades, mas cada
                        propriedade pertence a um único usuário.</p>
                </div>
                <div class="p-4 border border-gray-200 rounded-lg flex flex-col items-center text-center bg-white"><i
                        data-lucide="map" class="w-8 h-8 text-green-600 mb-3"></i>
                    <h4 class="font-bold text-sm mb-1">Solo → Propriedade</h4>
                    <p class="text-xs text-gray-500">Cada área de solo monitorada está localizada em uma propriedade
                        específica, garantindo que todos os dados possam ser rastreados até uma localização física.</p>
                </div>
                <div class="p-4 border border-gray-200 rounded-lg flex flex-col items-center text-center bg-white"><i
                        data-lucide="link" class="w-8 h-8 text-slate-600 mb-3"></i>
                    <h4 class="font-bold text-sm mb-1">Sensor → Solo</h4>
                    <p class="text-xs text-gray-500">Um sensor físico está instalado em uma única área de solo para
                        coletar dados, vinculando o hardware de campo aos registros lógicos do sistema.</p>
                </div>
                <div class="p-4 border border-gray-200 rounded-lg flex flex-col items-center text-center bg-white"><i
                        data-lucide="history" class="w-8 h-8 text-purple-600 mb-3"></i>
                    <h4 class="font-bold text-sm mb-1">Historico → Solo</h4>
                    <p class="text-xs text-gray-500">Todos os registros históricos estão diretamente vinculados à área
                        de solo da qual os dados foram coletados, permitindo análise de tendências.</p>
                </div>
                <div class="p-4 border border-gray-200 rounded-lg flex flex-col items-center text-center bg-white"><i
                        data-lucide="sprout" class="w-8 h-8 text-amber-600 mb-3"></i>
                    <h4 class="font-bold text-sm mb-1">Solo → Cultura</h4>
                    <p class="text-xs text-gray-500">Uma área de solo pode ser associada a uma cultura.
                        <code>cultura_id</code> nulável permite monitoramento durante períodos de pousio.</p>
                </div>
            </div>
            <div class="mt-6 bg-amber-50 border border-amber-100 rounded-lg p-4 flex items-start gap-3"><i
                    data-lucide="alert-circle" class="w-5 h-5 text-amber-600 mt-0.5"></i>
                <div>
                    <h5 class="font-bold text-amber-800 text-sm">Nota de Design</h5>
                    <p class="text-amber-700 text-sm mt-1">A chave estrangeira <code>cultura_id</code> na tabela Solo é
                        nulável, o que representa uma decisão de design deliberada. Isso confere flexibilidade ao
                        modelo, permitindo que o sistema monitore uma área de solo mesmo quando nenhuma cultura
                        específica está plantada (por exemplo, durante períodos de pousio).</p>
                </div>
            </div>
        </section>

        <section id="conclusao" class="bg-gray-900 rounded-xl p-8 text-gray-300">
            <div class="flex items-center gap-3 mb-6 border-b border-gray-800 pb-4"><i data-lucide="check-circle"
                    class="text-green-500 w-6 h-6"></i>
                <h2 class="text-2xl font-bold text-white">9. Conclusão</h2>
            </div>
            <div class="prose prose-invert max-w-none">
                <p>A estrutura do banco de dados <strong>db_soil</strong> foi cuidadosamente projetada para atender às
                    demandas do Soil Brief - Sistema Integrado de Monitoramento de Fertilidade do Solo com IoT e Aplicação Móvel. Sua finalidade principal é fornecer uma
                    base de dados robusta, organizada e relacional, capaz de suportar operações de agricultura de
                    precisão.</p>
                <p>A arquitetura de dados segmentada, que promove uma clara separação entre dados operacionais atuais
                    (Solo) e agregados analíticos (Historico), juntamente com o uso estratégico de tabelas de referência
                    (Cultura), capacita o sistema a oferecer não apenas monitoramento em tempo real, mas também análises
                    de longo prazo, essenciais para a otimização de recursos e o aumento da produtividade agrícola.</p>
            </div>
        </section>
    </main>

    <footer class="bg-gray-50 border-t border-gray-200 py-12">
        <div
            class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center gap-4">
            <div class="flex items-center gap-2"><i data-lucide="database" class="text-gray-400 w-5 h-5"></i><span
                    class="font-bold text-gray-700">db_soil</span></div>
            <p class="text-sm text-gray-500">Documentação Técnica Gerada em 2025</p>
        </div>
    </footer>

    <script>lucide.createIcons();</script>
</body>

</html>